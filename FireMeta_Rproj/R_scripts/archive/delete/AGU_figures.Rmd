---
title: "01_Wenas_percent_difference"
output: html_document
date: "2023-05-02"
editor_options: 
  chunk_output_type: console
---
The purpose of this script is to output figures for AGU_2023

```{r AGU plots}
vn = expression(paste(""*N*O[3]^"-"))

# within 5 years #
under_ten <- yearly_effect_size_combine_long %>% 
  filter(!Time_Since_Fire == ">10") 

no_dwc <- climate_summary_effect %>% 
  filter(!Climate == "Dwc")

ggplot(under_ten, aes(Effect_size, Climate, color = response_var),
       position = position_dodge(width = -0.5)) +
  geom_jitter(position = position_jitter(0.1), alpha = 0, size = 3) +
  geom_pointrange(aes(xmin = lower_ci_effect, xmax = upper_ci_effect,
                      color = response_var),
                  position = position_dodge(width = -0.5), size = 1.5, data = no_dwc) +
  geom_vline(xintercept = 0, linewidth = 1, color = "red") +
  xlim(-5, 8.5) +
  ylab("Koppen (Climate Classification)") +
  xlab("Effect Size") +
  geom_segment(aes(x = 6.25, xend = 6.25, y = 8.5, yend = 5.5), color = "black") +
  geom_segment(aes(x = 5.5, xend = 6.25, y = 8.5, yend = 8.5), color = "black") +
  geom_segment(aes(x = 5.5, xend = 6.25, y = 5.5, yend = 5.5), color = "black") +
  
  geom_segment(aes(x = 6.25, xend = 6.25, y = 5.3, yend = 1.5), color = "black") +
  geom_segment(aes(x = 5.5, xend = 6.25, y = 5.3, yend = 5.3), color = "black") +
  geom_segment(aes(x = 5.5, xend = 6.25, y = 1.5, yend = 1.5), color = "black") +
  
  geom_segment(aes(x = 6.25, xend = 6.25, y = 1.3, yend = 0.7), color = "black") +
  geom_segment(aes(x = 5.5, xend = 6.25, y = 1.3, yend = 1.3), color = "black") +
  geom_segment(aes(x = 5.5, xend = 6.25, y = 0.7, yend = 0.7), color = "black") +
  annotate("text",
           x = c(7.75, 7.75, 7),
           y = c(7, 3.5, 1),
           label = c("Continental", "Temperate", "Arid"),
           family = "", fontface = "bold") +
  scale_color_manual(values = c("#00AFBB", "#E7B800"),
                     guide = guide_legend(title = ""),
                     labels = c('DOC', vn)) +
  
  scale_y_discrete(labels=c("Dsb" = "Mediterranean", 
                            "Dfc" = "Subarctic",
                            "Dfb" = "Warm-humid",
                            "Csb" = "Warm-Mediterranean",
                            "Csa" = "Hot-Mediterranean",
                            "Cfb" = "Subtropical highland",
                            "Cfa" = "Humid subtropical",
                            "BSk" = "Cold semi-arid")) +
  theme_bw() +
  theme(axis.text.x = element_text(size = 30),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 40),
        axis.title.y = element_text(size = 35),
        legend.text = element_text(size = 30),
        legend.position = c(0.17, 0.80))
  

ggsave("AGU_Effect_Size_climate.pdf",
       path = here("initial_plots", "AGU"),
       width = 10, height = 8,  units = "in")



# TSF #
yearly_effect_size_combine_long$Time_Since_Fire <- factor(yearly_effect_size_combine_long$Time_Since_Fire, levels = c("0", "1", "2", "3", "4", "5", ">10"))

ggplot(yearly_effect_size_combine_long, aes(Time_Since_Fire, Effect_size, color = response_var),
       position = position_dodge(width = -0.5)) +
  geom_jitter(position = position_jitter(0.1), alpha = 0, size = 3) +
  geom_pointrange(aes(ymin = lower_ci_effect, ymax = upper_ci_effect,
                      color = response_var),
                  position = position_dodge(width = -0.5), size = 1.5, data = TSF_summary_effect) +
  geom_hline(yintercept = 0, linewidth = 1, color = "red") +
  ylim(-3, 4) +
  ylab("Effect Size") +
  xlab("Year since Fire") +
  scale_color_manual(values = c("#00AFBB", "#E7B800"),
                     guide = guide_legend(title = ""),
                     labels = c('DOC', vn)) +
  
  scale_x_discrete(labels=c("0" = "Year of Fire", "1" = "1-2",
                            "2" = "2-3", "3" = "3-4", "4" = "4-5",
                            "5" = "5-6", ">10" = ">10")) +
  theme_bw() +
  theme(axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 30),
        axis.title.x = element_text(size = 40),
        axis.title.y = element_text(size = 35),
        legend.text = element_text(size = 30),
        legend.position = c(0.17, 0.90))

ggsave("AGU_Effect_Size_TSF.pdf",
       path = here("initial_plots", "AGU"),
       width = 10, height = 8,  units = "in")
#


```
